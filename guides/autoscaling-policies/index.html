
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Explore our autoscaling policies CAST AI uses to maintain steady performance of your cluster at the lowest possible cost.">
      
      
      
        <link rel="canonical" href="https://docs.cast.ai/guides/autoscaling-policies/">
      
      <link rel="icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.2">
    
    
      
        <title>Autoscaling policies - CAST AI Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.f7951f6f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#ffffff">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nimbus+Sans:300,400,400i,700%7C&display=fallback">
        <style>:root{--md-text-font:"Nimbus Sans";--md-code-font:""}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-162225268-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
  <script async src="https://www.google-analytics.com/analytics.js"></script>


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#autoscaling-policies" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://cast.ai/" title="CAST AI Documentation" class="md-header__button md-logo" aria-label="CAST AI Documentation" data-md-component="logo">
      <img src="../../img/cast-logo-dark-blue.svg" alt="Cast logo" style="width: 5em;" />
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CAST AI Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Autoscaling policies
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://cast.ai/" title="CAST AI Documentation" class="md-nav__button md-logo" aria-label="CAST AI Documentation" data-md-component="logo">
      <img src="../../img/cast-logo-dark-blue.svg" alt="Cast logo" style="width: 5em;" />
    </a>
    CAST AI Documentation
  </label>
  
    <div class="md-nav__source">
      
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2">
          Getting started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Getting started" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Getting started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_2">
          AWS EKS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="AWS EKS" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          AWS EKS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/eks/eks/" class="md-nav__link">
        Connect and onboard EKS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/eks/remove-from-eks/" class="md-nav__link">
        Remove CAST AI from EKS
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_3">
          GCP GKE
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="GCP GKE" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          GCP GKE
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/gke/gke/" class="md-nav__link">
        Connect and onboard GKE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/gke/remove-from-gke/" class="md-nav__link">
        Remove CAST AI from GKE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/gke/gcp-marketplace-onboarding/" class="md-nav__link">
        Onboard Organization using GCP Marketplace
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4" type="checkbox" id="__nav_2_4" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_4">
          Azure AKS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Azure AKS" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          Azure AKS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/aks/aks/" class="md-nav__link">
        Connect and onboard AKS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/aks/remove-from-aks/" class="md-nav__link">
        Remove CAST AI from AKS
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_5" type="checkbox" id="__nav_2_5" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_5">
          kOps
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="kOps" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_5">
          <span class="md-nav__icon md-icon"></span>
          kOps
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/kops/kops/" class="md-nav__link">
        Connect and onboard kOps
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/kops/remove-from-kops/" class="md-nav__link">
        Remove CAST AI from kOps
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3">
          Product overview
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Product overview" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Product overview
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_1">
          Console
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Console" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Console
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../product-overview/console/clusters/" class="md-nav__link">
        Clusters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../product-overview/console/nodes/" class="md-nav__link">
        Nodes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../product-overview/console/audit-log/" class="md-nav__link">
        Audit Log
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../product-overview/console/autoscaler/" class="md-nav__link">
        Autoscaler
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../product-overview/console/cost-report/" class="md-nav__link">
        Cost report
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../product-overview/console/logs/" class="md-nav__link">
        Logs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../product-overview/console/api/" class="md-nav__link">
        API Access Keys
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../product-overview/console/security-insights/" class="md-nav__link">
        Security Report
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../product-overview/autoscaler/">Autoscaler</a>
          
            <label for="__nav_3_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Autoscaler" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Autoscaler
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../product-overview/autoscaler/features/subnets/" class="md-nav__link">
        Subnets selection
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../product-overview/rebalancing/">Rebalancing</a>
          
            <label for="__nav_3_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Rebalancing" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Rebalancing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../product-overview/rebalancing/preparation/" class="md-nav__link">
        Preparation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../product-overview/rebalancing/run/" class="md-nav__link">
        Rebalance your cluster
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../product-overview/hosted-components/" class="md-nav__link">
        Hosted Components
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../product-overview/security/" class="md-nav__link">
        Security Report
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4">
          Guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../external-clusters/" class="md-nav__link">
        External cluster troubleshooting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pod-placement/" class="md-nav__link">
        Pod placement
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../volumes/" class="md-nav__link">
        Dynamic volume provisioning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../connect-to-node/" class="md-nav__link">
        Connect to node
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Autoscaling policies
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Autoscaling policies
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scoped-autoscaler-mode" class="md-nav__link">
    Scoped autoscaler mode
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cluster-cpu-limits-policy" class="md-nav__link">
    Cluster CPU limits policy
  </a>
  
    <nav class="md-nav" aria-label="Cluster CPU limits policy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuring-cpu-limits-policy" class="md-nav__link">
    Configuring CPU limits policy
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#horizontal-pod-autoscaler-hpa-policy" class="md-nav__link">
    Horizontal Pod Autoscaler (HPA) policy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotpreemptive-instances-policy" class="md-nav__link">
    Spot/Preemptive Instances policy
  </a>
  
    <nav class="md-nav" aria-label="Spot/Preemptive Instances policy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interruption-tolerance" class="md-nav__link">
    Interruption tolerance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spot-fallback" class="md-nav__link">
    Spot fallback
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unscheduled-pods-policy" class="md-nav__link">
    Unscheduled pods policy
  </a>
  
    <nav class="md-nav" aria-label="Unscheduled pods policy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#headroom-attributes" class="md-nav__link">
    Headroom attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-constraints" class="md-nav__link">
    Node constraints
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#provisioning-decision" class="md-nav__link">
    Provisioning decision
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-the-unscheduled-pods-policy" class="md-nav__link">
    Configuring the unscheduled pod's policy
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#node-deletion-policy" class="md-nav__link">
    Node deletion policy
  </a>
  
    <nav class="md-nav" aria-label="Node deletion policy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#disable-deletion-of-specific-nodes" class="md-nav__link">
    Disable deletion of specific node(s)
  </a>
  
    <nav class="md-nav" aria-label="Disable deletion of specific node(s)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#labeling-the-nodes" class="md-nav__link">
    Labeling the node(s)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removing-the-label" class="md-nav__link">
    Removing the label
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evictor" class="md-nav__link">
    Evictor
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#policies-precedence-rules" class="md-nav__link">
    Policies precedence rules
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../start-saving-quickly/" class="md-nav__link">
        Start saving quickly
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hpa/" class="md-nav__link">
        Horizontal Pod Autoscaler
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spot/" class="md-nav__link">
        Spot/Preemptible Instances
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vpa/" class="md-nav__link">
        Right Sizing recommendations with VPA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gpu/" class="md-nav__link">
        GPU instances autoscaling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../node-kernel-tuning/" class="md-nav__link">
        Node kernel tuning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../evictor/" class="md-nav__link">
        Evictor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cluster-controller/" class="md-nav__link">
        Cluster controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kvisor-security/" class="md-nav__link">
        Kvisor security
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../node-configuration/" class="md-nav__link">
        Node Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mutating-admision-webhook/" class="md-nav__link">
        Mutating Admission Webhook
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/" class="md-nav__link">
        Cluster metrics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../agent-monitoring/" class="md-nav__link">
        Agent status monitoring
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes-permissions/" class="md-nav__link">
        Kubernetes permissions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cloud-permissions/" class="md-nav__link">
        Cloud permissions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../custom-secret-management/" class="md-nav__link">
        Custom secret management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../webhooks/" class="md-nav__link">
        How to setup Notification Webhooks
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/overview/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/authentication/" class="md-nav__link">
        Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/specification/" class="md-nav__link">
        Specification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/terraform-provider/" class="md-nav__link">
        Terraform provider
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/cli/" class="md-nav__link">
        CLI
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6">
          Administration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Administration" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Administration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../administration/configure-payment-method/" class="md-nav__link">
        Configure payment details
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://cast.ai/release-notes/" class="md-nav__link">
        Release notes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://status.cast.ai/" class="md-nav__link">
        Service status
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/castai" class="md-nav__link">
        CAST AI GitHub
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://join.slack.com/t/castai-community/shared_invite/zt-nwtbsbqq-dWOBiUgLtIGMsUSup7Xksw" class="md-nav__link">
        CAST AI Community Slack
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://console.cast.ai" class="md-nav__link">
        CAST AI Console
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://castai.medium.com/" class="md-nav__link">
        CAST AI on Medium
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://twitter.com/cast_ai" class="md-nav__link">
        CAST AI Twitter
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scoped-autoscaler-mode" class="md-nav__link">
    Scoped autoscaler mode
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cluster-cpu-limits-policy" class="md-nav__link">
    Cluster CPU limits policy
  </a>
  
    <nav class="md-nav" aria-label="Cluster CPU limits policy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuring-cpu-limits-policy" class="md-nav__link">
    Configuring CPU limits policy
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#horizontal-pod-autoscaler-hpa-policy" class="md-nav__link">
    Horizontal Pod Autoscaler (HPA) policy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotpreemptive-instances-policy" class="md-nav__link">
    Spot/Preemptive Instances policy
  </a>
  
    <nav class="md-nav" aria-label="Spot/Preemptive Instances policy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interruption-tolerance" class="md-nav__link">
    Interruption tolerance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spot-fallback" class="md-nav__link">
    Spot fallback
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unscheduled-pods-policy" class="md-nav__link">
    Unscheduled pods policy
  </a>
  
    <nav class="md-nav" aria-label="Unscheduled pods policy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#headroom-attributes" class="md-nav__link">
    Headroom attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-constraints" class="md-nav__link">
    Node constraints
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#provisioning-decision" class="md-nav__link">
    Provisioning decision
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-the-unscheduled-pods-policy" class="md-nav__link">
    Configuring the unscheduled pod's policy
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#node-deletion-policy" class="md-nav__link">
    Node deletion policy
  </a>
  
    <nav class="md-nav" aria-label="Node deletion policy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#disable-deletion-of-specific-nodes" class="md-nav__link">
    Disable deletion of specific node(s)
  </a>
  
    <nav class="md-nav" aria-label="Disable deletion of specific node(s)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#labeling-the-nodes" class="md-nav__link">
    Labeling the node(s)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removing-the-label" class="md-nav__link">
    Removing the label
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evictor" class="md-nav__link">
    Evictor
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#policies-precedence-rules" class="md-nav__link">
    Policies precedence rules
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/castai/docs/edit/main/docs/guides/autoscaling-policies.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="autoscaling-policies">Autoscaling policies<a class="headerlink" href="#autoscaling-policies" title="Permanent link">&para;</a></h1>
<p>Autoscaling policies define the set of rules based on which your cluster is monitored and scaled to maintain steady
performance at the lowest possible cost.</p>
<p>This topic describes the available policy configuration options and provides guidance on how to configure them.</p>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h2>
<p>Onboard a cluster - see <a href="../../getting-started/overview/">connect cluster</a></p>
<p>Once you've connected a cluster, select it and navigate to the <strong>Autoscaler</strong> menu.</p>
<p><img alt="" src="autoscaler.png" /></p>
<h2 id="scoped-autoscaler-mode">Scoped autoscaler mode<a class="headerlink" href="#scoped-autoscaler-mode" title="Permanent link">&para;</a></h2>
<p>Autoscaler features described below can be made to act only on a subset of your cluster. By marking specific workloads for autoscaling, only that subset will be considered by the unscheduled pods policy, and the empty nodes policy will only clean up nodes that the autoscaler has previously created.</p>
<p>While this mode is turned on, the autoscaler-created nodes will have a specific taint: <code>scheduling.cast.ai/scoped-autoscaler=true:NoSchedule</code>. This ensures that only the subset of workloads specifically meant for the scoped autoscaler will be scheduled on these nodes.</p>
<p>For pods that you wish to be included, update your relevant deployments to contain this configuration:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">template</span><span class="p">:</span>
    <span class="nt">spec</span><span class="p">:</span>
      <span class="nt">nodeSelector</span><span class="p">:</span>
        <span class="nt">provisioner.cast.ai/managed-by</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cast.ai</span>
      <span class="nt">tolerations</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">key</span><span class="p">:</span> <span class="s">&quot;scheduling.cast.ai/scoped-autoscaler&quot;</span>
        <span class="nt">operator</span><span class="p">:</span> <span class="s">&quot;Exists&quot;</span>
        <span class="nt">effect</span><span class="p">:</span> <span class="s">&quot;NoSchedule&quot;</span>
</code></pre></div>
<p>The node selector will ensure that pods only schedule on CAST AI-provisioned nodes. Also, this specific selector is what the scoped autoscaler is looking for when deciding which unsheduled pods are within the scope.</p>
<p>Toleration is required for the above-described reasons: we want the pods to actually be able to be scheduled on provisioned nodes. If toleration is not present, this will be treated as misconfiguration and the pod will be ignored.</p>
<p>Evictor also needs to be configured to run in scoped mode. Call <code>PUT /v1/kubernetes/clusters/{clusterId}/policies</code> API by supplying full policy config with evictor settings updated, partial snippet bellow (with scopesMode: True)</p>
<div class="highlight"><pre><span></span><code>  <span class="err">...</span>
    <span class="nt">&quot;evictor&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;enabled&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nt">&quot;dryRun&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="nt">&quot;aggressiveMode&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="nt">&quot;scopedMode&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nt">&quot;cycleInterval&quot;</span><span class="p">:</span> <span class="s2">&quot;5s&quot;</span><span class="p">,</span>
      <span class="nt">&quot;allowed&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nt">&quot;nodeGracePeriodMinutes&quot;</span><span class="p">:</span> <span class="mi">2</span>
    <span class="p">}</span>
  <span class="err">...</span>
</code></pre></div>
<h2 id="cluster-cpu-limits-policy">Cluster CPU limits policy<a class="headerlink" href="#cluster-cpu-limits-policy" title="Permanent link">&para;</a></h2>
<p>Each CAST AI cluster size can be limited by <strong>the total amount</strong> of vCPUs available on all the worker nodes
used to run workloads.
If disabled, the cluster can upscale indefinitely and downscale to 0 worker nodes, depending on the actual
resource consumption.</p>
<h3 id="configuring-cpu-limits-policy">Configuring CPU limits policy<a class="headerlink" href="#configuring-cpu-limits-policy" title="Permanent link">&para;</a></h3>
<p>You can adjust a cluster's CPU limits settings either via the <a href="https://console.cast.ai/">CAST AI console:</a></p>
<p><img alt="" src="cluster_size.png" /></p>
<p>or via the <a href="https://api.cast.ai/v1/spec/#/cluster-policies/UpsertPolicies">CAST AI policies API endpoint</a> by setting
values for</p>
<div class="highlight"><pre><span></span><code><span class="nt">&quot;clusterLimits&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;cpu&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;maxCores&quot;</span><span class="p">:</span> <span class="err">&lt;value&gt;</span><span class="p">,</span>
      <span class="nt">&quot;minCores&quot;</span><span class="p">:</span> <span class="err">&lt;value&gt;</span>
    <span class="p">},</span>
    <span class="nt">&quot;enabled&quot;</span><span class="p">:</span> <span class="err">&lt;value&gt;</span>
<span class="p">}</span>
</code></pre></div>
<p>The new settings will propagate immediately.</p>
<h2 id="horizontal-pod-autoscaler-hpa-policy">Horizontal Pod Autoscaler (HPA) policy<a class="headerlink" href="#horizontal-pod-autoscaler-hpa-policy" title="Permanent link">&para;</a></h2>
<p>For now, the HPA policy is only supported on clusters created in CAST AI. See <a href="../hpa/">HPA documentation</a> for a detailed overview.</p>
<h2 id="spotpreemptive-instances-policy">Spot/Preemptive Instances policy<a class="headerlink" href="#spotpreemptive-instances-policy" title="Permanent link">&para;</a></h2>
<p><img alt="" src="spot-policies.png" /></p>
<p>This policy instructs the CAST AI optimization engine to purchase Spot / Preemptive instances and place specifically labelled pods on those instances. CAST AI automatically handles instance interruptions and replaces instances when they are terminated by the CSP. You can find a detailed guide on how to configure your workloads to run on Spot instances <a href="../spot/">here</a>.</p>
<p>The following configuration settings can be applied to the policy.</p>
<h3 id="interruption-tolerance">Interruption tolerance<a class="headerlink" href="#interruption-tolerance" title="Permanent link">&para;</a></h3>
<p>Using the <em>interruption tolerance</em> setting, you can restrict which instances types the autoscaler should consider when choosing the Spot instance type. The default "Cost efficient" option means that the autoscaler will choose the cheapest option, regardless of the selected instance type's reliability; choosing "Least interrupted" will ensure that selection will be done only from most reliable instances.</p>
<h3 id="spot-fallback">Spot fallback<a class="headerlink" href="#spot-fallback" title="Permanent link">&para;</a></h3>
<p>By using this feature, you can guarantee that workloads designated for spot instances have capacity to run even if spot inventory is temporarily not available. To mitigate the impact of spot drought, CAST AI provisions <em>fallback</em> node (i.e. a temporary on-demand node) and use it to schedule the impacted workloads. Once the configured time expires, CAST AI will automatically attempt to find the suitable spot node. If it is available, it will get provisioned - then the <em>fallback</em> node will be drained and deleted. As a result, the impacted workloads will get scheduled on the spot node in the same way as prior to the spot drought event.</p>
<h2 id="unscheduled-pods-policy">Unscheduled pods policy<a class="headerlink" href="#unscheduled-pods-policy" title="Permanent link">&para;</a></h2>
<p>A pod becomes unschedulable when the Kubernetes scheduler cannot find a node to which it can assign the pod.
For instance, a pod can request more CPU or memory than the resources available on any of the worker nodes.</p>
<p>In many such cases, this indicates the need to scale up by adding additional nodes to the cluster.</p>
<p>The CAST AI autoscaler is equipped with a mechanism to handle this.</p>
<h3 id="headroom-attributes">Headroom attributes<a class="headerlink" href="#headroom-attributes" title="Permanent link">&para;</a></h3>
<p>Headroom is a buffer of spare capacity (in terms of both memory and CPU) to ensure that cluster can meet suddenly increased demand for resources. It is based on the currently available total worker nodes resource capacity.</p>
<p>For example, if headroom for memory and CPU are both set to 10%,
and the cluster consists of 2 worker nodes equipped with 2 cores and 4GB RAM each, <em>a total of 0.4 cores and 819MB</em>
would be considered as headroom in the next cluster size increase phase.</p>
<h3 id="node-constraints">Node constraints<a class="headerlink" href="#node-constraints" title="Permanent link">&para;</a></h3>
<p>Node constraints limit the possible node pool for CAST AI to choose from when adding a node to a cluster. Entered <strong>Min CPU</strong> and <strong>Max CPU</strong> as well as <strong>Min memory</strong> and <strong>Max memory</strong> values are respected when selecting the next node to be added to the cluster, this way user influences the composition of the cluster in terms of size and number of nodes.</p>
<p>Since this decision is driven by the customer and not by CAST AI optimization engine, it might not result in the most cost effective node added. However, this feature is particularly  beneficial when migrating into CAST AI selected nodes and securing additional capacity upfront (i.e. adding larger nodes, but knowing that during migration they would be filled up).</p>
<p>The system supports the following CPU to Memory ratios: 1:2, 1:4 and 1:8. Based on the example presented in the picture, CAST AI would consider 4CPU16GiB RAM and 4CPU 32GiB RAM instances</p>
<p><img alt="" src="node_constraints.png" /></p>
<h3 id="provisioning-decision">Provisioning decision<a class="headerlink" href="#provisioning-decision" title="Permanent link">&para;</a></h3>
<ul>
<li>After receiving the unschedulable pods event, the CAST AI recommendation engine will select the best
price/performance ratio node capable of accommodating all of the currently unschedulable pods plus headroom or respecting node constraints.</li>
<li>CAST AI will then provision it and join with the cluster. This process usually takes a few minutes, depending on the cloud service provider of your choice.</li>
<li>Currently, only a single node will be added at a time. If any unschedulable pods still remain, the cycle is
repeated until all the pods are scheduled (provided that the reason was insufficient resources).</li>
</ul>
<h3 id="configuring-the-unscheduled-pods-policy">Configuring the unscheduled pod's policy<a class="headerlink" href="#configuring-the-unscheduled-pods-policy" title="Permanent link">&para;</a></h3>
<p>You can enable/disable the unschedulable pod's policy and set headroom settings as well as node constraints either on the <a href="https://console.cast.ai/">CAST AI console</a> or via the <a href="https://api.cast.ai/v1/spec/#/cluster-policies/UpsertPolicies">CAST AI policies API endpoint</a> by setting values for headroom:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&quot;unschedulablePods&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;enabled&quot;</span><span class="p">:</span> <span class="err">&lt;value&gt;</span><span class="p">,</span>
    <span class="nt">&quot;headroom&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;cpuPercentage&quot;</span><span class="p">:</span> <span class="err">&lt;value&gt;</span><span class="p">,</span>
        <span class="nt">&quot;enabled&quot;</span><span class="p">:</span> <span class="err">&lt;value&gt;</span><span class="p">,</span>
        <span class="nt">&quot;memoryPercentage&quot;</span><span class="p">:</span> <span class="err">&lt;value&gt;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>or for node constraints:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&quot;unschedulablePods&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;enabled&quot;</span><span class="p">:</span> <span class="err">&lt;value&gt;</span><span class="p">,</span>
    <span class="nt">&quot;headroom&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;enabled&quot;</span><span class="p">:</span> <span class="err">&lt;value&gt;</span><span class="p">,</span>
        <span class="nt">&quot;maxCpuCores&quot;</span><span class="p">:</span> <span class="err">&lt;value&gt;</span><span class="p">,</span>
        <span class="nt">&quot;maxRamMib&quot;</span><span class="p">:</span> <span class="err">&lt;value&gt;</span><span class="p">,</span>
        <span class="nt">&quot;minCpuCores&quot;</span><span class="p">:</span> <span class="err">&lt;value&gt;</span><span class="p">,</span>
        <span class="nt">&quot;minRamMib&quot;</span><span class="p">:</span> <span class="err">&lt;value&gt;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>It may take a few minutes for the new settings to propagate.</p>
<h2 id="node-deletion-policy">Node deletion policy<a class="headerlink" href="#node-deletion-policy" title="Permanent link">&para;</a></h2>
<p>This policy will automatically remove nodes from your cluster when they no longer have scheduled workloads.
This allows your cluster to maintain a minimal footprint and reduce cloud costs.</p>
<p><img alt="" src="node_deletion_policy.png" /></p>
<p>If <strong>Keep empty node alive for</strong> is set to 0, CAST AI moves to delete an empty node as soon as it is detected. In cases when a user wants to keep the empty node in the cluster for a period of time, a time parameter can be set, effectively delaying the deletion.</p>
<h3 id="disable-deletion-of-specific-nodes">Disable deletion of specific node(s)<a class="headerlink" href="#disable-deletion-of-specific-nodes" title="Permanent link">&para;</a></h3>
<p>If you annotate or label a node with <code>autoscaling.cast.ai/removal-disabled="true"</code>, the <em>Node deletion policy</em> won't delete it even if it is completely empty.</p>
<h4 id="labeling-the-nodes">Labeling the node(s)<a class="headerlink" href="#labeling-the-nodes" title="Permanent link">&para;</a></h4>
<p>You can label nodes using <code>kubectl</code> in the following fashion:</p>
<ul>
<li>Specific node(s):</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># replace &lt;node_name&gt; with your node name of choice</span>
kubectl label node &lt;node_name&gt; <span class="o">[</span>&lt;node_name&gt; ...<span class="o">]</span> autoscaling.cast.ai/removal-disabled<span class="o">=</span><span class="nb">true</span>
<span class="c1"># e.g. to label node `myclusternode-e359fefa-d3a2` run this command:</span>
kubectl label node myclusternode-e359fefa-d3a2 autoscaling.cast.ai/removal-disabled<span class="o">=</span><span class="nb">true</span>
<span class="c1"># e.g. to label two nodes `myclusternode-e359fefa-d3a2` and myclusternode-anothernode run this command:</span>
kubectl label node myclusternode-e359fefa-d3a2 myclusternode-anothernode autoscaling.cast.ai/removal-disabled<span class="o">=</span><span class="nb">true</span>
</code></pre></div>
<ul>
<li>Many nodes using label selector</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># replace &lt;label&gt; with your node name of choice</span>
kubectl label node -l &lt;label&gt; autoscaling.cast.ai/removal-disabled<span class="o">=</span><span class="nb">true</span>
<span class="c1"># e.g. to label nodes in availability zone `europe-west3-c` run this command:</span>
kubectl label node -l topology.kubernetes.io/zone<span class="o">=</span>europe-west3-c autoscaling.cast.ai/removal-disabled<span class="o">=</span><span class="nb">true</span>
</code></pre></div>
<ul>
<li>All nodes</li>
</ul>
<div class="highlight"><pre><span></span><code>kubectl label node --all autoscaling.cast.ai/removal-disabled<span class="o">=</span><span class="nb">true</span>
</code></pre></div>
<h4 id="removing-the-label">Removing the label<a class="headerlink" href="#removing-the-label" title="Permanent link">&para;</a></h4>
<p>In order to instruct policy to delete the node, you need to remove the label. Using previously described methods, instruct <code>kubectl</code> to label a node with <code>autoscaling.cast.ai/removal-disabled-</code> (note the <code>-</code> symbol instead of <code>=true</code>).</p>
<h4 id="evictor">Evictor<a class="headerlink" href="#evictor" title="Permanent link">&para;</a></h4>
<p>CAST AI Evictor also respects this label or annotation so it won't try to evict marked nodes.</p>
<h2 id="policies-precedence-rules">Policies precedence rules<a class="headerlink" href="#policies-precedence-rules" title="Permanent link">&para;</a></h2>
<p>If multiple policies are enabled and multiple rules are triggered during the same evaluation period, they will be
handled in the following order:</p>
<ol>
<li><a href="#cluster-cpu-limits-policy">Cluster CPU limits policy</a></li>
<li><a href="#horizontal-pod-autoscaler-hpa-policy">Horizontal Pod Autoscaler (HPA) policy</a></li>
<li><a href="#unscheduled-pods-policy">Unscheduled pods policy</a></li>
<li><a href="#node-deletion-policy">Node deletion policy</a></li>
</ol>

              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  <!-- Link to previous and/or next page -->
  
  <nav
          class="md-footer__inner md-grid"
          aria-label="Footer"
  >

    <!-- Link to previous page -->
    
    
    <a
            href="../connect-to-node/"
            class="md-footer__link md-footer__link--prev"
            aria-label="Previous: Connect to node"
            rel="prev"
    >
      <div class="md-footer__button md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </div>
      <div class="md-footer__title">
        <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
          Connect to node
        </div>
      </div>
    </a>
    

    <!-- Link to next page -->
    
    
    <a
            href="../start-saving-quickly/"
            class="md-footer__link md-footer__link--next"
            aria-label="Next: Start saving quickly"
            rel="next"
    >
      <div class="md-footer__title">
        <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
          Start saving quickly
        </div>
      </div>
      <div class="md-footer__button md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
      </div>
    </a>
    
  </nav>
  

  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-social">
  
</div>
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.indexes"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.0bbba5b5.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.649a939e.min.js"></script>
      
    
  </body>
</html>